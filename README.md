# MTMG: A Framework for Generating Adversarial Examples Targeting Multiple Learning-based Malware Detection Systems
## Introduction
Multi-Target Malware Generation (MTMG) is an attack framework designed to target multiple learning-based malware detection systems (LB-MDS) concurrently. Utilizing reinforcement learning, MTMG can orchestrate simultaneous attacks on multiple LB-MDS systems. The framework chooses an obfuscation technique and its relevant parameters from the action space, based on the observed state of the malware. This selection enables the creation of adversarial examples intended to deceive numerous LB-MDS. Comprehensive details are available in our research paper titled "MTMG: A Framework for Generating Adversarial Examples Targeting Multiple Learning-based Malware Detection Systems" (PDF format).

MTMG is a framework designed to attack learning-based malware detection systems (LB-MDS), demonstrating formidable effectiveness against a range of systems, including commercial antivirus software. When targeting a single commercial antivirus software, MTMG can achieve an attack success rate of over 90%. Against multiple commercial antivirus softwares, anonymized as AV1-AV6, MTMG consistently achieves an attack success rate of over 80%.

The reason we have not made MTMG open-source is due to potential misuse. Malware developers could leverage MTMG to cloak their malicious software, evading detection by commercial antivirus programs and causing serious harm. Current LB-MDS have no defensive capability against adversarial samples generated by MTMG. Releasing it to the public now may lead to widespread misuse, resulting in significant damage. To address these concerns, we have devised a three-phase plan:

**Validation Phase**: To underscore the robust offensive capabilities of MTMG, we are offering access to a malware database. This repository will contain both original malware and versions modified by MTMG, serving as tangible evidence of the tool's efficiency.

**Binary Release Phase**: For those with specific needs, upon providing details about their organization, personal information, and intended use via email, we will supply them with the binary version of MTMG.

**Open-Source Phase**: Once LB-MDS systems are equipped to correctly handle malicious samples generated by MTMG, we will release the source code to the public.

This GitHub repository is currently dedicated to the Validation Phase, offering both the original malware and versions modified by MTMG. In addition, we've provided their feature vectors to facilitate verification of MTMG's effectiveness and support subsequent research endeavors. We plan on continually updating this repository and will, in due time, roll out the binary release phase and the open-source phase.

## Download
For researchers who don't require the original malware and MTMG-malware samples, we've extracted features using the [LIEF](https://lief.quarkslab.com/) project (version 0.9.0). These features are consistent with the [Ember](https://github.com/elastic/ember) dataset (details). Every sample is represented as a 2381-feature vector. Access to these feature vectors and sample models is open to everyone. You can download the data from [Google Drive](). 
- MTMG: Contains raw features for all samples
- Models: Contains the Ember model, and we will provide an example of how to use the MTMG dataset to evaluate the robustness of the EMBER model

**Caution**: Researchers who need the original malware and MTMG-modified samples should reach out to [Lichen Jia](lcjia457@gmail.com). When getting in touch, please include your Gmail address so we can provide access to the Google Drive folder containing the dataset. To prevent the potential misuse of these malware samples, it's imperative that before contacting us, you acknowledge and consent to the terms outlined below:

- Sharing Restrictions: Kindly refrain from distributing the data (barring project co-authors). However, we're open to catering to requests from other researchers.

- Usage Intent: Briefly articulate your intended purpose for these binaries. A detailed plan is not mandatory.

- For Academics: If you're affiliated with an academic institution, please use your institutional email for correspondence. Additionally, share a link to a webpage (under the university domain) that confirms your name and affiliation.

- For Industrial Researchers: If you're based in a research lab within the industry, please write to us from your official company email. Introduce yourself and provide background on your organization. Additionally, include a justification letter (PDF format, on official letterhead) elucidating the reasons behind your request for the dataset.

Be advised that any email failing to comply with these stipulations may be disregarded. We will continually update a public directory listing organizations that have been granted access to these samples.


## Installation
1. Clone this repo from git:

```bash
git clone https://github.com/mtmg-malware/MTMG.git
```

2. We recommend setting up a Python 3.6.9 virtual environment (other Python 3.7 or above versions might also work but didn't test).

```bash
cd MTMG
pip install -r requirements.txt
```

## Evaluating LB-MDS Robustness with MTMG-Malware:
1. Evaluate the robustness of LB-MDS using MTMG-Malware

```bash
python evaluation.py
```

## How to Expand the the Dataset:
To facilitate future researchers in defining their own datasets or expanding the ERMDS dataset, we provide a feature extraction script called feature.py. Modify the paths in this file and run the script to obtain sample features in JSON format.

```bash
python feature.py
```

## Citing
```

```
